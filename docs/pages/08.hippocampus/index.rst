.. _posthippocampus:

.. title:: Hippocampal post-processing

Hippocampal feature post-processing
============================================================

This section describes how to generate raw and normalized features sampled along hippocampal surfaces generated by HippUnfold.


Define your directories: Hippocampus
--------------------------------------------------------

z-brains requires input and output directories:

``root_path`` points to the BIDS-format dataset that stores imaging data
``rawdir`` contains the raw imaging data
``micapipedir`` contains the output of micapipe previously run on the BIDS dataset
``hippdir`` contains the output of hippunfold previously run on the BIDS dataset
``outdir`` points to the directory that will hold z-brains outputs

In practice, these should be declared as variables: 

    .. code-block:: bash
        :caption: Declaring path variables
        :linenos:

        # path for dataset in BIDS structure
        root_path=/path/to/BIDS_dataset
        rawdir=${root_path}/rawdata
        micapipedir=${root_path}/derivatives/micapipe_folder
        hippdir=${root_path}/derivatives/hippunfold_folder
        outdir=${root_path}/derivatives/z-brains_folder


Run hippocampal post-processing
--------------------------------------------------------

After defining our directories, we can move on to processing our first patient. 
Let's declare which patient we want to process (with their ID in the BIDS directory, omitting the 'sub-' and the session that should be processed if necessary).

    .. code-block:: bash
        :caption: Declaring subject variables
        :linenos:

        id=PX001
        ses=01

To process the subject, we can specify the command as follows: 

    .. code-block:: bash
        :caption: Basic z-brains run: hippocampal processing
        :linenos:

        z-brains -sub "$id" -ses "$ses" \
            -rawdir "${rawdir}" \
            -micapipedir "${micapipedir}" \
            -hippdir "${hippdir}" \
            -outdir "${outdir}" \
            -run proc \
            -struct hippocampus \
            -verbose 2

This will generate surface-based hippocampal features at the default smoothing (2mm) and mesh resolution (both 2mm and 0p5m template resolution) for all available modalities.

.. admonition:: Customize your z-brains run!

	A list of options and flags can be specified for a more personalized run of z-brains. Check out the help menu ``z-brains -help``

