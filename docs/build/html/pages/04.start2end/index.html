<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Start to finish with `micapipe` &mdash; micapipe  documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sphinx_tabs/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/mica-pipe_colors.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.js"></script>
        <script src="../../_static/sphinx_tabs/tabs.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Processing databases with micapipe" href="../04.databases/index.html" />
    <link rel="prev" title="Automatic Bundle Segmentation" href="../05.autotract/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #261F4A" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/html_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../01.install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01.whatyouneed/index.html">Usages Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01.whatsnew/index.html">What’s new?</a></li>
</ul>
<p class="caption"><span class="caption-text">Processing modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02.structuralproc/index.html">Structural processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.dwiproc/index.html">Diffusion-weighted imaging processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.restingstateproc/index.html">fMRI processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.microstructproc/index.html">Microstructural profile covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.qc/index.html">Quality control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.aslproc/index.html">Arterial spin labeling processing</a></li>
</ul>
<p class="caption"><span class="caption-text">Additional tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../05.mic2bids/index.html">From DICOMS to BIDS: <code class="docutils literal notranslate"><span class="pre">mic2bids</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../05.micapipe_cleanup/index.html"><code class="docutils literal notranslate"><span class="pre">micapipe_cleanup</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../05.micapipe_anonymize/index.html"><code class="docutils literal notranslate"><span class="pre">micapipe_anonymize</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../05.autotract/index.html">Automatic Bundle Segmentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Processing step by step: start to finish with <code class="docutils literal notranslate"><span class="pre">micapipe</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#download-an-open-access-dataset">1. Download an open access dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#converting-to-bids">2. Converting to BIDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#validating-bids">3. Validating BIDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-micapipe">4. Running micapipe</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualize-the-qc-report">5. Visualize the QC report</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04.databases/index.html">Processing databases with <code class="docutils literal notranslate"><span class="pre">micapipe</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../04.matrices/index.html">Main output matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04.surfaces/index.html">Surface visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04.gradients/index.html">Building gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04.tckdownsample/index.html">How to downsample a tractogram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04.faq/index.html">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">References &amp; Acknowledgements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../06.citingmicapipe/index.html">Citing micapipe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06.references/index.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06.acknowledge/index.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #261F4A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">micapipe</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Start to finish with `micapipe`</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/pages/04.start2end/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="processing-step-by-step-start-to-finish-with-micapipe">
<span id="startend"></span><h1>Processing step by step: start to finish with <code class="docutils literal notranslate"><span class="pre">micapipe</span></code><a class="headerlink" href="#processing-step-by-step-start-to-finish-with-micapipe" title="Permalink to this headline">¶</a></h1>
<p>In this section, you will find two examples with the necessary steps of processing a dataset with micapipe.</p>
<div class="section" id="download-an-open-access-dataset">
<h2>1. Download an open access dataset<a class="headerlink" href="#download-an-open-access-dataset" title="Permalink to this headline">¶</a></h2>
<p>The first step is to identify a dataset and to ensure that you have the computational resources, including storage and computational processing power. In this this example, we will focus on two datasets: Human Connectome Project (HCP) and (MICA-MICs). Other widely used repositories for BIDS-compliant datasets may be found on e.g., OpenNeuro (<a class="reference external" href="https://openneuro.org">https://openneuro.org</a>) or the Canadian Open Neuroscience Platform (CONP; <a class="reference external" href="http://portal.conp.ca">http://portal.conp.ca</a>).</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-0-0 docutils container">
<div class="docutils container">
<p>HCP</p>
</div>
</div>
<div class="item sphinx-data-tab-0-1 docutils container">
<div class="docutils container">
<p>MICs</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-0-0 active docutils container">
<div class="figure align-left">
<a class="reference internal image-reference" href="../../_images/hcp_logo.png"><img alt="../../_images/hcp_logo.png" src="../../_images/hcp_logo.png" style="width: 106.4px; height: 75.60000000000001px;" /></a>
</div>
<p>To download the dataset, it is necessary to create an account first and accept the open access terms. Additionally, HCP uses a third-party software called Aspera Connect to boost data transfer speed. Further information about this software and its installation can be found on the HCP website. Once all the requirements are fulfilled, login to  <a class="reference external" href="https://db.humanconnectome.org">https://db.humanconnectome.org</a>, and select the data you would like to download, in this case the WU-Minn HCP Retest Data with the processing filter of “Unprocessed”.
We will use micapipe here to process the structural, resting state fMRI run-1 and Diffusion data (dir97_dir-RL).
This dataset requires about 350 GB of storage.</p>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-0-1 docutils container">
<div class="figure align-left">
<a class="reference internal image-reference" href="../../_images/mics_logo.png"><img alt="../../_images/mics_logo.png" src="../../_images/mics_logo.png" style="width: 102.00000000000001px; height: 96.22000000000001px;" /></a>
</div>
<p>There are two options available to download the MICs dataset, a direct download or using Datalad.
This dataset requires approximately 70 GB of storage. The dataset and additional documentation can be found on the CONP website:
<a class="reference external" href="https://portal.conp.ca/dataset?id=projects/mica-mics">https://portal.conp.ca/dataset?id=projects/mica-mics</a>.</p>
</div>
</div>
</div>
<div class="section" id="converting-to-bids">
<h2>2. Converting to BIDS<a class="headerlink" href="#converting-to-bids" title="Permalink to this headline">¶</a></h2>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-1-0 docutils container">
<div class="docutils container">
<p>HCP</p>
</div>
</div>
<div class="item sphinx-data-tab-1-1 docutils container">
<div class="docutils container">
<p>MICs</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-1-0 active docutils container">
<p>The HCP dataset was created before the rise of BIDS. Here, we provide a custom-build script that will transform an HCP directory into BIDS format, using the metadata provided in the HCP S1200 release reference manual.</p>
<ol class="arabic simple">
<li><p>Clone the micapipe-supplementary github directory:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/MICA-MNI/micapipe-supplementary.git
</pre></div></td></tr></table></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Change into the project directory:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><span class="nb">cd</span><span class="w"> </span>micapipe-supplementary<span class="w"> </span>/functions
</pre></div></td></tr></table></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Run the code specifying the full path to the HCP data and the output HCP directory in BIDS.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span>./hcp2bids<span class="w"> </span>-in<span class="w"> </span>&lt;full_path_to&gt;/HCP_data<span class="w"> </span>-out<span class="w"> </span>&lt;full_path_to&gt;/HCP_bids
</pre></div></td></tr></table></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-1-1 docutils container">
<p>This dataset is BIDS-compliant, and no further conversion is needed.</p>
</div>
</div>
</div>
<div class="section" id="validating-bids">
<h2>3. Validating BIDS<a class="headerlink" href="#validating-bids" title="Permalink to this headline">¶</a></h2>
<p>At this point, MICs and HCP are BIDS conform. However, any new dataset that has been recently acquired and that you wish to make BIDS-compliant (see specifications at <a class="reference external" href="http://bids-specification.readthedocs.io">http://bids-specification.readthedocs.io</a>), should be validated with tools provided by BIDS, such as the BIDS-validator (<a class="reference external" href="https://bids-standard.github.io/bids-validator/">https://bids-standard.github.io/bids-validator/</a>). Another example can be found on the tutorial <a class="reference external" href="../05.mic2bids/index.html">From Dicoms to BIDS: mic2bids</a></p>
</div>
<div class="section" id="running-micapipe">
<h2>4. Running micapipe<a class="headerlink" href="#running-micapipe" title="Permalink to this headline">¶</a></h2>
<p>Once micapipe has been installed (see Installation), one can run the pipeline. From the main directory of the dataset the command would be:</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-2-0 docutils container">
<div class="docutils container">
<p>HCP</p>
</div>
</div>
<div class="item sphinx-data-tab-2-1 docutils container">
<div class="docutils container">
<p>MICs</p>
</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-2-0 active docutils container">
<p>Running HCP for subject 250932</p>
<div class="highlight-bash notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span>micapipe<span class="w"> </span>-bids<span class="w"> </span>HCP_bids<span class="w"> </span>-out<span class="w"> </span>derivatives<span class="w"> </span>-sub<span class="w"> </span><span class="m">250932</span><span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-proc_structural<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-proc_freesurfer<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-post_structural<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-proc_dwi<span class="w"> </span>-dwi_acq<span class="w"> </span>dir97<span class="w"> </span><span class="se">\</span>
<span class="w">            </span>-dwi_main<span class="w"> </span>sub-250932dwi/sub-250932_acq-dir97_dir-LR_dwi.nii.gz<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-dwi_rpe<span class="w"> </span>sub-250932/dwi/sub-250932_acq-dir97_dir-RL_sbref.nii.gz<span class="w">  </span><span class="se">\</span>
<span class="w">       </span>-SC<span class="w"> </span>-tracts<span class="w"> </span>20M<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-proc_rsfmri<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-mainScanStr<span class="w"> </span>task-rest_dir-LR_run-2_bold<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-fmri_rpe<span class="w"> </span>sub-250932/func/sub-250932_task-rest_dir-RL_run-1_bold.nii.gz<span class="se">\</span>
<span class="w">       </span>-regress_WM_CSF<span class="w"> </span>-noFIX<span class="w"> </span>-regAffine<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-GD<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-Morphology<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-QC_subj
</pre></div></td></tr></table></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment sphinx-data-tab-2-1 docutils container">
<p>Running MICs for subject HC001 session 01:</p>
<div class="highlight-bash notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span>micapipe<span class="w"> </span>-bids<span class="w"> </span>rawdata<span class="w"> </span>-out<span class="w"> </span>derivatives<span class="w"> </span>-sub<span class="w"> </span>HC001<span class="w"> </span>-ses<span class="w"> </span><span class="m">01</span><span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-proc_structural<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-proc_freesurfer<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-post_structural<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-proc_dwi<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-SC<span class="w"> </span>-tracts<span class="w"> </span>20M<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-proc_rsfmri<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-GD<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-Morphology<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-MPC<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-QC_subj
</pre></div></td></tr></table></div>
</div>
</div>
</div>
</div>
<div class="section" id="visualize-the-qc-report">
<h2>5. Visualize the QC report<a class="headerlink" href="#visualize-the-qc-report" title="Permalink to this headline">¶</a></h2>
<p>The individual QC tool is a html report with detailed information of each processing step, which can be used for rapid visualization of processing status, core registrations, and data matrices by parcellation scheme and module. The files can be found under each subject’s directory QC and opened with any browser:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&lt;outputDirectory&gt;/micapipe/&lt;sub&gt;/QC/&lt;sub&gt;_micapipe_qc.html
</pre></div>
</div>
<p>The group level QC generates a report with all completed and processed modules by subject. The report consists of a color-coded table with rows as subjects and columns as the pipeline modules. The file is located under the micapipe directory as shown below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&lt;outputDirectory&gt;/micapipe/micapipe_progress.html
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../04.databases/index.html" class="btn btn-neutral float-right" title="Processing databases with micapipe" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../05.autotract/index.html" class="btn btn-neutral float-left" title="Automatic Bundle Segmentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2022, micapipe

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a 
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a> and modified by SL and RRC 

</footer>

        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
         .wy-nav-content { max-width: none; }
  </style>


  <footer>
    
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a 
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. Modified by SL 🤠 

  </footer>



</body>
</html>